\documentclass[a4paper,12pt]{article}
\usepackage{amsmath,amssymb}
\usepackage{tikz}
\usepackage{fullpage}
\usepackage{bm}
\usepackage{float}
\usetikzlibrary{bayesnet}
\DeclareMathOperator{\E}{\mathbb{E}}

\begin{document}

Inference lies at the heart of the motivation for estimating parameters of the RC, for example, to understand whether parameters are changed due to an intervention, dependent on a site of stimulation or between groups of participants. Increasing the statistical power of an inferential analysis can lead to a reduction in the required number of participants. One way to increase power over commonly used frequentist methods (e.g. t-tests) applied after parameter estimation is to construct conditions or groups directly into a hierarchical Bayesian model. Such a model can summarize parameters of multiple participants across different groups and conditions into group-parameters, which can then be used to test hypotheses.

Itâ€™s often the case that there is some group structure present within participants. The default model can then be extended to model such structure which allows for direct comparison of group parameters. We introduce partial-pooling of group parameters by placing a \textit{group-specific} prior on each parameter. The group-specific priors are then informed by global priors which are shared between groups. The global priors are informed by hyperpriors, which are shared between all groups and chosen to be weakly informative. \\

Fig. 4.3.2 shows the graphical representation of group model implemented by hbmep. In section 5.2, we use this model $($with $N_G = 2$$)$ to directly compare the group threshold parameters $\mu_a$ of uninjured and injured participants.

\begin{figure}[H]
    \centering
    \tikz{ %
        % Obs
        \node[obs,fill] (obs) {$y$};%

        % Deterministic mu, beta
        \node[det,above=of obs,xshift=-1.4cm,yshift=-.5cm,fill] (beta) {$\beta$}; %
        \node[det,above=of obs,xshift=1.4cm,yshift=0cm,fill] (mu) {$\mu$}; %
        \node[obs,above=of obs,xshift=-.8cm,yshift=1cm,fill] (intensity) {$x$};%
        \plate[inner sep=.1cm, yshift=.07cm] {plate_obs} {(obs)(mu)(beta)(intensity)} {$\text{intensity } i: 1, 2 \ldots n(p)$};

        % % PRIORS
        % a, b, v
        \node[latent,above=of obs,yshift=2.2cm,xshift=-.9cm,fill] (a) {$a$};
        \node[latent,right=of a,xshift=0cm,fill] (b) {$b$};
        % \node[latent,right=of b,xshift=-.9cm,fill] (v) {$v$};
        % L, ell, H
        \node[latent,right=of b,xshift=-.9cm,fill] (L) {$L$};
        \node[latent,right=of L,xshift=-.9cm,fill] (ell) {$\ell$};
        \node[latent,right=of ell,xshift=-.9cm,fill] (H) {$H$};
        % g1, g2
        \node[latent,left=of a,xshift=.0cm,fill] (g2) {${c_2}$};
        \node[latent,left=of g2,xshift=.9cm,fill] (g1) {${c_1}$};

        % Participants plate
        \plate[inner sep=.25cm, yshift=.2cm] {plate_participant} {(a)(b)(L)(H)(ell)(g1)(g2)(plate_obs)} {$\text{participant } p:1, 2 \ldots n(g)$};

        % % HYPER-PRIORS
        \node[latent,above=of a,xshift=-.4cm,yshift=-.3cm,fill] (a_mean) {$\mu_a$};
        \node[latent,above=of a,xshift=.8cm,yshift=1.5cm,fill] (a_scale) {$\sigma_a$};
        \node[latent,above=of b,yshift=1.5cm,fill] (b_scale) {$\sigma_b$};
        \node[latent,above=of g2,yshift=1.5cm,fill] (g2_scale) {$\sigma_{c_2}$};
        \node[latent,above=of g1,yshift=1.5cm,fill] (g1_scale) {$\sigma_{c_1}$};
        \node[latent,above=of L,yshift=1.5cm,fill] (L_scale) {$\sigma_L$};
        \node[latent,above=of H,yshift=1.5cm,fill] (H_scale) {$\sigma_H$};
        % \node[latent,above=of v,fill] (v_scale) {$\sigma_v$};
        \node[latent,above=of ell,yshift=1.5cm,fill] (ell_scale) {$\sigma_\ell$};
        \node[latent,above=of a_mean,xshift=-.45cm,yshift=.8cm,fill] (a_loc_loc) {$\mu_{\mu_a}$};
        \node[latent,above=of a_mean,xshift=.45cm,yshift=.8cm,fill] (a_loc_scale) {$\sigma_{\mu_a}$};

        % Groups plate
        \plate[inner sep=.25cm, yshift=.2cm] {plate_group} {(a_mean)(plate_participant)} {$\text{group } g: 1, 2 \ldots N_G$};

        % Edges from Hyper-priors to Priors
        \edge {g1_scale} {g1}
        \edge {g2_scale} {g2}
        \edge {a_mean, a_scale} {a}
        \edge {b_scale} {b}
        \edge {L_scale} {L}
        \edge {H_scale} {H}
        % \edge {v_scale} {v}
        \edge {ell_scale} {ell}

        % Edges from Priors to Deterministic
        \edge {g1, g2} {beta}
        \edge {a, b, L, ell, H} {mu}

        % Edges to obs
        \edge {intensity} {beta, mu}
        \edge {beta,mu} {obs};
        \edge {mu} {beta};

        \edge {a_loc_loc, a_loc_scale} {a_mean}

        % Muscles plate
        \plate[inner sep=.1cm, yshift=.05cm] {plate_muscle} {(plate_group)} {$\text{muscle } m: 1, 2 \ldots N_M$};
    }
\end{figure}

Although the group threshold parameters $\mu_a$ and $\sigma_a$ are assumed to be generated from a common population, we consciously avoid pooling these parameters. The reason for doing so is two fold. Firstly, often there is enough information available to directly specify these parameters. Secondly, we expect these parameters to be different between groups. For instance, the thresholds are the most likely to be affected by injury.

\end{document}
